/*
	This wrapper is basically to isolate Thirdparty code
*/

#include "common/pop3commons.h"
#include "debug/pop3debug.h"
#include "common/pop3defs.h"

// OpenSSL library include for SSL
#include <openssl/bio.h>
#include <openssl/ssl.h>
#include <openssl/err.h>

#ifndef __POP3_SSL__WRAPPER
#define __POP3_SSL__WRAPPER

namespace pop3
{
	class SSLWrapper
	{
		private:
			//Openssl initializations
            
			SSL_CTX* ctx;
			SSL* ssl;
			SSL_METHOD *method;

			SSLWrapper():ctx(0), ssl(0), method(0){}
			pop3socket::POP3_SOCKET_STATUS_E SSLInit();
			pop3socket::POP3_SOCKET_STATUS_E SSLConnect(int fd = -1, int sslVerifyType = 0, const string& ca_path = "", 
													const string& ca_client_cert = "", const string& cn = "");
			pop3socket::POP3_SOCKET_STATUS_E SSLRead(char* buffer, const size_t bufSize, int& bytesRead);
			pop3socket::POP3_SOCKET_STATUS_E SSLWrite(const char* data, const size_t sendLen);
			pop3socket::POP3_SOCKET_STATUS_E SSLDisconnect();
			pop3socket::POP3_SOCKET_STATUS_E MapSSLError(int ret);

			friend class SocketManager;
	};
}

#endif
